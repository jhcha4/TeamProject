<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers.kysboard-mapper">
	<!-- 리스트 -->
	<select id="boardList" resultType="Kys_BoardVo">
	select * from tbl_product_board
	order by p_num 
	</select>
	
	<!-- 상품 보기 -->
	<select id="boardSelectBy" resultType="Kys_BoardVo">
		select * from tbl_product_board
		where p_num = #{p_num}
	
	</select>
	<!-- 상품 등록 -->
	<insert id="boardInsert">
	insert into tbl_product_board(p_num, p_name,
								 p_content, p_price, 
								 p_main, p_serve)
				values(seq_p_num.nextval, #{p_name}, 
						#{p_content}, #{p_price}, 
						#{p_main},	#{p_serve})
	</insert>
	<!-- 상품 수정 -->
	<update id="boardUpdate">
	update tbl_product_board set 
	p_name = #{p_name},
	p_content = #{p_content},
	p_price = #{p_price}
	where p_num = #{p_num}
	</update>
	<!-- 상품 삭제 컬럼추가-->
	<delete id="boardDelete">
	   update tbl_product_board set
 	   p_deleted  = 'D'
 	   where p_num = #{p_num};
	</delete>
	
	<!-- 상품 조건 검색 -->
	<select id="selectByTow" resultType="Kys_BoardVo">
		select * from tbl_product_board 
		where p_main = #{p_main} and p_serve = #{p_serve}  
	</select>
	
	<!-- 게시글 수 -->
	<select id="getCount" resultType="int">
	select count(*) from tbl_product_board
	<include refid="serch"></include>
	</select>
	
	<!-- 게시글 페이징 -->
	<select id="boardListPage" resultType="kys_BoardVo">
	select * from (
			select rownum rnum, a.* from(
    		select * from tbl_product_board
    				<include refid="serch"></include>
   					 order by p_num desc)
   					  a)
    where rnum between #{startRow} and #{endRow}
	</select>
	<sql id="serch">
		<if test="p_main != null and p_main !='' ">
		
					where p_main like #{p_main}
					or p_serve like #{p_serve}
    			
		</if>
	</sql>
	
	
</mapper>
